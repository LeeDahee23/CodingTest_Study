## SSL(Secure Sockets Layer)

- 컴퓨터 네트워크에 `통신 보안`을 제공하기 위해 설계된 암호 프로토콜
- 클라이언트/서버 응용 프로그램이 `네트워크로 통신을 하는 과정`에서 `도청, 간섭, 위조를 방지`하기 위해서 설계 → 해커가 전송되는 데이터를 보거나 훔치는 것을 막기 위함
- 웹 브라우저와 같이 웹 응용 프로그램과 서버 간의 커뮤니케이션을 암호화
- 이메일, 메시지, 보이스오버 IP(VoIP: IP를 사용하여 음성 정보를 전송하는 기술) 등 다른 커뮤니케이션을 암호화

## TLS(Transport Layer Security)

- SSL(Secure Sockets Layer)이라고 불리는 이전의 암호화 프로토콜에서 발전한 것
- TLS와 SSL의 역사(?)
    
    TLS ver1.0이 SSL ver3.1로서 개발을 시작했지만 Netscape와 더 이상 연관이 없음을 명시하기 위해 발표 전에 프로토콜의 이름이 변경됨.
    
    ⇒ TLS와 SSL은 가끔 서로 바꿔서 사용됨
    
- 참고: “보안 계층”이라는 독립적인 프로토콜 계층, 응용 계층과 전송 계층 사이에

---

## 공개키/개인키, 대칭키/비대칭키 암호화 방식

- 자세히
    1. 공개키와 개인키
        1. 공개키: 누구나 볼 수 있도록 공개되어 있는 키
        2. 개인키: 공개되지 않고 비밀리에 사용되는 키
    2. 대칭키 암호화와 비대칭키 암호화
        1. 대칭키 암호화 방식: 암복호화에 사용하는 키가 동일한 암호화 방식, 송수신자 모두 똑같은 키를 가지고 있어야 함.
        2. 비대칭키 암호화(공개키 암호화 방식): 암복호화에 사용하는 키가 서로 다름
        

---

## TLS/SSL handshake

- SSL은 TCP 기반의 프로토콜 → SSL handshake 전에 TCP 3-way handshake 또한 수행
- 언제? 사용자가 https를 통해 웹 사이트를 탐색하고 브라우저가 처음 해당 웹 사이트의 원본 서버를 쿼리하기 시작할 때마다 발생 ⇒ 브라우저 검색창에 https로 된 도메인을 검색
- 단계
    
    출처: CloudFlare - TLS handshake의 원리는 무엇일까요? | SSL handshake
    

1. 클라이언트 헬로 메시지
    1. 클라이언트가 서버로 헬로 메시지를 전송
    2. 클라이언트가 지원하는 TLS 버전, 지원되는 암호 제품군(안전한 통신 연결을 수립하는 데 사용하는 알고리즘 세트), 클라이언트 무작위(랜덤 데이터) 전송
2. 서버 헬로 메시지
    1. 클라이언트 헬로 메시지에 대한 응답
    2. 서버의 SSL 인증서, 서버에서 선택한 암호 제품군, 서버 무작위 전송
3. 인증: 클라이언트가 서버의 SSL 인증서를 인증서 발행 기관(CA)을 통해 검증
4. 예비 마스터 암호(Client key exchange)
    1. 클라이언트가 예비 마스터 암호라고 하는 무작위 바이트 문자열을 하나 더 전송. 
    2. SSL 인증서를 통해 받은 공개키로 암호화, 서버가 개인 키로만 해독할 수 있음.
5. 개인 키 사용: 서버가 예비 마스터 암호를 해독
6. 세션 키 생성: 클라이언트와 서버가 모두 클라이언트 무작위, 서버 무작위, 예비 마스터 암호를 이용해 세션 키를 생성. 같은 결과여야 함.
7. 클라이언트 준비 완료: 클라이언트가 세션 키로 암호화된 “완료” 메시지 전송
8. 서버 준비 완료: 서버가 세션 키로 암호화된 “완료” 메시지 전송
9. 안전한 대칭 암호화 성공: 핸드셰이크 완료, 세션 키를 이용해 통신 진행

- TLS 1.3 handshake
    1. 클라이언트 헬로: 프로토콜 버전, 클라이언트 무작위, 암호 모음 목록이 포함된 클라이언트 헬로 메시지를 보냄. 기본적으로 클라이언트는 서버가 선호하는 키 교환 방법을 알고 있다고 가정함.
    2. 서버가 마스터 암호를 생성: 서버는 클라이언트에게 클라이언트 무작위, 클라이언트 매개변수, 암호 그룹을 받음. 서버도 자체적으로 서버 무작위를 생성. 마스터 암호 생성
    3. 서버 헬로 및 “완료”: 서버의 인증서, 디지털 서명, 서버 무작위, 선택한 암호 그룹 포함. “완료” 메시지도 전송
    4. 마지막 단계 및 클라이언트 “완료”: 클라이언트가 서명 및 인증서를 확인하고 마스터 암호를 생성한 후 “완료” 메시지를 전송
    5. 안전한 대칭 암호화 성공

## 참고자료

[위키백과 - HTTPS](https://ko.wikipedia.org/wiki/HTTPS)

[위키백과 - 전송 계층 보안](https://ko.wikipedia.org/wiki/%EC%A0%84%EC%86%A1_%EA%B3%84%EC%B8%B5_%EB%B3%B4%EC%95%88#cite_note-3)

[네이버 블로그 - SK infosec 공식 블로그 - 웹사이트 보안을 위한 방법, SSL이란? (feat. SSL과 HTTPS의 차이)](https://blog.naver.com/skinfosec2000/222135874222)

[CloudFlare - TLS handshake의 원리는 무엇일까요? | SSL handshake](https://www.cloudflare.com/ko-kr/learning/ssl/what-happens-in-a-tls-handshake/)

[티스토리 - TLS handshake는 어떻게 진행되는가?](https://sunrise-min.tistory.com/entry/TLS-Handshake%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%A7%84%ED%96%89%EB%90%98%EB%8A%94%EA%B0%80)
