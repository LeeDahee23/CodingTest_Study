# 프로세스 주소 공간

프로세스가 메모리를 할당 받으면, 자신만의 방법으로 메모리를 관리하기 위해 이 공간들을 어떤 `구조`로 관리함.

프로세스가 생성되면 사용자 영역에 [코드 영역, 데이터 영역, 힙 영역, 스택 영역]으로 나뉘어 저장됨.

[사진 첨부]

출처: [https://inpa.tistory.com/entry/👩‍💻-프로세스-⚔️-쓰레드-차이#한눈에_이해하는_프로세스__스레드_개념](https://inpa.tistory.com/entry/%F0%9F%91%A9%E2%80%8D%F0%9F%92%BB-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%E2%9A%94%EF%B8%8F-%EC%93%B0%EB%A0%88%EB%93%9C-%EC%B0%A8%EC%9D%B4#%ED%95%9C%EB%88%88%EC%97%90_%EC%9D%B4%ED%95%B4%ED%95%98%EB%8A%94_%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4__%EC%8A%A4%EB%A0%88%EB%93%9C_%EA%B0%9C%EB%85%90)

- 참고) 동적 / 정적 할당
    - 동적 할당: 프로그램 실행 도중(런타임) 메모리의 크기를 결정, 프로그램 실행 단계에서 할당하고, 다 쓰면 반납
    - 정적 할당: 컴파일 단계에서 메모리가 미리 할당되고 함수 혹은 프로그램이 끝나면 자동 반납, 메모리의 크기가 하드코딩
    - 동적/정적 할당 ≠ 동적/정적 영역

## 코드 영역(Code, Text)

- 컴퓨터가 실행할 수 있는 코드, 기계어로 이루어진 명령어 저장
- CPU가 실행할 명령어가 담겨 있기 때문에 `읽기 전용`
- 정적 할당 영역

## 데이터 영역(Data)

- 잠깐 썼다가 없앨 데이터가 아닌, 프로그램이 실행되는 동안 유지할 데이터가 저장
- 전역 변수, 정적 변수(static), 상수(const, final)
    - 전역 변수, 정적 변수 특징
        1. 차이점
            1. 정적 변수는 초기화가 딱 한번만 진행됨
            2. 프로그램이 시작될 때 생성 및 초기화되고 프로그램이 끝날 때 사라짐
            3. 함수의 매개변수로 사용할 수 없음
        2. 장점
            1. 모든 객체가 공유하는 메모리
        3. 단점
            1. garbage collector의 관리 영역 밖에 존재하므로 static을 자주 사용하면 프로그램의 종료시까지 메모리가 할당된 채로 존재
                - garbage collection: 가비지(유효하지 않은 메모리)를 알아서 해제함.
- 정적 할당 영역

## 힙 영역(Heap)

- 프로그래머가 직접 할당할 수 있는 저장 공간
- 힙 영역에 메모리 공간을 할당했다면 언젠가는 해당 공간을 반환해야 함
== 더 이상 해당 메모리 공간을 사용하지 않겠어~ 라고 운영체제에 말하는 것
    - 메모리 누수
        
        메모리 공간을 반환하지 않는다면 할당한 공간은 메모리 내에 계속 남아 메모리 낭비를 초래함.
        
- 참조형 데이터(ex. 클래스) 등의 데이터
- 동적 할당 영역
    - 메모리의 낮은 주소에서 높은 주소로 할당
    - 런타임에 크기가 결정됨

## 스택 영역(Stack)

- 데이터를 일시적으로 저장하는 공간 == 잠깐 쓰다가 말 값
- 매개 변수, 지역 변수(함수의 실행이 끝나면 사라짐)
- 일시적 데이터는 스택 영역에 PUSH 되고, 더 이상 필요하지 않은 데이터는 POP 됨
- 재귀 함수가 너무 깊게 호출되거나 함수가 지역변수를 너무 많이 가지고 있어 stack 영역을 초과하면 stack overflow 에러가 발생함.
- 동적 할당 영역 ❓
    - 높은 주소에서 낮은 주소로 할당
    - 컴파일 시에 크기가 결정됨

[사진 첨부]

출처: [https://www.inflearn.com/questions/981575/스택-영역의-크기는-정적인가요-동적인가요](https://www.inflearn.com/questions/981575/%EC%8A%A4%ED%83%9D-%EC%98%81%EC%97%AD%EC%9D%98-%ED%81%AC%EA%B8%B0%EB%8A%94-%EC%A0%95%EC%A0%81%EC%9D%B8%EA%B0%80%EC%9A%94-%EB%8F%99%EC%A0%81%EC%9D%B8%EA%B0%80%EC%9A%94)

# 각 영역을 나눠 쓰는 이유

- 코드 영역
    - 코드는 실행되면 바뀌지 않아서 항상 똑같음 → 같은 걸 반복 X
- 데이터 영역
    - 전역변수, 정적 변수 등 어디에서든 접근이 가능한, 공통 변수 특성을 활용
    - 공유해서 메모리 절약

# 출처

https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=eludien&logNo=221462352935

[https://velog.io/@klm03025/운영체제-프로세스-주소-공간](https://velog.io/@klm03025/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%A3%BC%EC%86%8C-%EA%B3%B5%EA%B0%84)

[도서] 혼자 공부하는 컴퓨터 구조 + 운영체제(강민철, 한빛미디어)
