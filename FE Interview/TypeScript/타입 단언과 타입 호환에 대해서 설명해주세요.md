## 타입 단언(Assertion)

#### 개념

- 타입스크립트가 추론하지 못하는 타입을 개발자가 직접 명시해주는 문법
- 실제 데이터 타입을 변경하지 않고 에러만 방지함

#### 사용 문법

- [변수] as [타입]
- 변수 앞에 <타입>을 써서 부여하기
  - HTML 태그와 혼동될 수 있음

#### 사용 예시

```typescript
const div = document.querySelector('div') as HTMLDivElement;
console.log(div.textContent); // no error
```

- HTMLDivElement로 타입 단언을 하지 않으면 DOM은 `HTMLDivElement | null` 유니온 타입이기 때문에 null이 할당 될 수 있어 div의 프로퍼티 접근에 대해 에러 발생

## 타입 호환(Compatibility)

#### 개념

- 특정 타입이 다른 타입에 잘 맞는지 의미

#### 기본 원칙

- 할당 가능성(Assignability): 타입 A가 타입 B에 할당 가능하다는 것은, A의 모든 필수 속성과 메소드가 B에도 존재하며, 그 타입이 호환 가능하다는 것을 의미
- 구조적 타이핑(Structural Typing): 타입이 구조에 의해 결정되며, 명시적으로 타입이 선언되어 있지 않아도 객체의 구조가 같다면 같은 타입으로 간주된다는 의미
  - 할당하는 타입이 할당받는 타입의 구조보다 크다면 서로 호환됨
- 인터페이스와 클래스: 인터페이스나 클래스가 동일한 속성과 메소드를 가진다면, 이들은 서로 호환 가능. 클래스의 경우, private 또는 protected 멤버가 있는 경우에는 이 원칙이 적용되지 않음
- 함수 호환성: 할당하는 함수가 할당받는 함수보다 매개변수를 적게 가져야 호환됨.

#### 사용 예시

- 변수 타입 할당

  ```typescript
  interface Person {
    name: string;
  }
  interface Developer {
    name: string;
    skill: string;
  }

  let developer: Developer;
  let person: Person;

  person = developer; // no error
  developer = person; // error
  ```

  - person에 skill 프로퍼티가 보장되지 않기 때문에 developer에 할당 ❌

- 함수 호환성

  ```typeScript
  let fn1 = (a: number) => 0;
  let fn2 = (a: number, b: string) => 0;

  fn1 = fn2; // error (fn2가 더 많은 매개변수를 가짐)
  fn2 = fn1; // no error (fn1이 더 적은 매개변수를 가짐)
  ```

  - fn1이 fn2보다 더 적은 매개변수를 가지기 때문에 fn1에는 할당 불가능, fn2에는 할당 가능

## 꼬리 질문

- 타입 단언과 타입 선언의 차이는 무엇인가요?
  - 타입 단언과 타입 선언은 유사하지만 사용 목적에 차이가 있습니다. 타입 선언은 요소에 특정 타입을 명시적으로 지정하는 것입니다. 타입스크립트가 타입 추론을 하는 것이 아닌, 개발자가 직접 타입을 지정함으로써 잠재적인 타입 관련 오류를 방지합니다. 그래서 안전하게 코드를 작성하는 것을 목적으로 합니다. 반면, 타입 단언은 개발자가 타입스크립트 타입 추론보다 더 정확한 타입 정보를 알고 있을 때 사용합니다. 그래서 타입스크립트 컴파일러의 타입 검사를 우회하여 개발자가 직접 타입을 지정하고자 할 때 사용합니다. 타입 단언은 코드의 타입 안정성을 저하시킬 수 있기 때문에 신중하게 사용해야 합니다.
- 타입 단언에서 발생할 수 있는 위험성은 무엇이고, 어떻게 방지할 수 있나요?
  - 타입 단언 시 개발자가 잘못된 가정을 하면 타입 관련 오류가 발생할 수 있습니다. 이를 방지하기 위해 타입 단언은 필요한 최소한으로 사용하고, 타입스크립트의 타입 추론 기능을 최대한 활용하는 것이 좋습니다.
  - 예: querySelector로 불러온 없는 DOM 요소는 null인데, 해당 요소에 대해 타입 단언을 하면 런타임 시 오류 발생
- 타입 호환성에서 발생할 수 있는 일반적인 오류와 해결하는 방법은 무엇인가요?
  - 타입 호환성 문제는 주로 인터페이스 또는 클래스 간의 속성 불일치로 인해 발생합니다. 이를 해결하기 위해 인터페이스와 클래스 간의 속성과 메소드를 일관되게 유지하고, 필요한 경우 타입 가드나 타입 선언을 통해 명시적으로 타입을 정의해야 합니다.

## 참고

- https://abangpa1ace.tistory.com/entry/TS%EA%B0%95%EC%9D%98-%EC%9E%85%EB%AC%B8-1-%EA%B0%9C%EC%9A%94-%EB%B0%8F-%EB%B0%B0%EA%B2%BD
- ChatGPT
